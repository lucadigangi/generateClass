<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload App</title>
    <!-- Include Amazon Cognito SDK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aws-sdk/2.1071.0/aws-sdk.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/amazon-cognito-identity-js/5.2.6/amazon-cognito-identity.min.js"></script>
</head>
<body>
    <h1>File Upload App</h1>

    <!-- Sign-in Form -->
    <div id="sign-in-form" style="display: none;">
        <label for="username">Username:</label>
        <input type="text" id="username">
        <br>
        <label for="password">Password:</label>
        <input type="password" id="password">
        <br>
        <button onclick="signIn()">Sign In</button>
    </div>

    <!-- File Upload Form -->
    <div id="file-upload-form" style="display: none;">
        <form action="/upload" method="post" enctype="multipart/form-data">
            <label for="file">Choose a file:</label>
            <input type="file" name="file" id="file" accept=".csv">
            <br>
            <input type="submit" value="Upload">
        </form>
    </div>

    <!-- JavaScript to handle Amazon Cognito authentication -->
    <script>
        const poolData = {
            UserPoolId: 'your-user-pool-id',
            ClientId: 'your-client-id'
        };

        const userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

        function signIn() {
            const username = document.getElementById('username').value;
            const password = new AmazonCognitoIdentity.CognitoUserAttribute({ Name: 'password', Value: document.getElementById('password').value });
            
            const authenticationData = {
                Username: username,
                Password: password
            };

            const authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(authenticationData);
            const userData = {
                Username: username,
                Pool: userPool
            };

            const cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);

            cognitoUser.authenticateUser(authenticationDetails, {
                onSuccess: function (session) {
                    // User is signed in, show the file upload form
                    document.getElementById('sign-in-form').style.display = 'none';
                    document.getElementById('file-upload-form').style.display = 'block';
                },
                onFailure: function (err) {
                    alert('Sign-in failed: ' + err);
                }
            });
        }
    </script>
</body>
</html>
